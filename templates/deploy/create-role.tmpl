/* Generated by: ~/.sqitch/templates/deploy/create-role.tmpl */

-- Deploy [% project %]:[% change %] to [% engine %]
[% FOREACH item IN requires -%]
-- requires: [% item %]
[% END -%]
[% FOREACH item IN conflicts -%]
-- conflicts: [% item %]
[% END -%]

BEGIN;

CREATE ROLE [% rolename %] WITH
[% IF superuser %] SUPERUSER[% ELSE %] NOSUPERUSER[% END %]
[% IF createdb %] CREATEDB[% ELSE %] NOCREATEDB[% END %]
[% IF createrole %] CREATEROLE[% ELSE %] NOCREATEROLE[% END %]
[% IF inherit %] INHERIT[% ELSE %] NOINHERIT[% END %]
[% IF login %] LOGIN[% ELSE %] NOLOGIN[% END %]
[% IF replication %] REPLICATION[% ELSE %] NOREPLICATION[% END %]
[% IF bypassrls %] BYPASSRLS[% ELSE %] NOBYPASSRLS[% END %]
[% IF connlimit %] CONNECTION LIMIT [% connlimit %][% END -%]
[% IF login && password %] PASSWORD '[% password %]'[% ELSE %] PASSWORD NULL[% END -%]
[% IF validuntil %] VALID UNTIL '[% validuntil %]'[% END -%]
[% IF inrole %] IN ROLE [% inrole.join(', ') %][% END -%]
[% IF role %] ROLE [% role.join(', ') %][% END -%]
[% IF admin %] ADMIN [% admin.join(', ') %][% END -%]
[% IF sysid %] SYSID [% sysid %][% END -%];

COMMENT ON ROLE [% rolename %] IS [% IF rolecomment %]'[% rolecomment %]'[% ELSE %]NULL[% END %];

COMMIT;